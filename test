CREATE TABLE monthly_insights (
month varchar(15),
average time(0),
max time(0),
mode int,
member_transactions int,
casual_transactions int)


SELECT SUM(member_transactions) as total_member_transactions,SUM(casual_transactions) as total_casual_transactions 
from monthly_insights

With cte as(SELECT mode, DENSE_RANK () over (order by mode desc) as RANK from monthly_insights)
SELECT TOP 1 mode FROM cte WHERE RANK = 1


With cte as(SELECT month,casual_transactions, DENSE_RANK () over (partition by month order by casual_transactions)as Rank from monthly_insights)
SELECT TOP 3 month,casual_transactions FROM cte ORDER BY casual_transactions desc


With cte as(SELECT month,member_transactions, DENSE_RANK () over (partition by month order by member_transactions)as Rank from monthly_insights)
SELECT TOP 3 month,member_transactions FROM cte ORDER BY member_transactions desc


Select Top 1 month,convert(varchar,average)as average from monthly_insights
group by month, average
ORDER BY average desc


SELECT month,
	CASE 
		WHEN member_transactions > 300000 THEN 'Most Busy' 
		WHEN member_transactions BETWEEN 200000 AND 299999 THEN 'Very Busy'
		WHEN member_Transactions BETWEEN 100000 AND 199999 THEN 'Busy'
		WHEN member_Transactions < 100000 THEN 'Slow'
		ELSE NULL 
		END as Activity from monthly_insights


SELECT month,
	CASE 
		WHEN casual_transactions > 300000 THEN 'Most Busy' 
		WHEN casual_transactions BETWEEN 200000 AND 299999 THEN 'Very Busy'
		WHEN casual_transactions BETWEEN 100000 AND 199999 THEN 'Busy'
		WHEN casual_Transactions < 100000 THEN 'Slow'
		ELSE NULL 
		END as Activity from monthly_insights


With cte as(SELECT month, MIN(casual_transactions) as min_casual_transactions FROM monthly_insights 
GROUP BY month)
Select TOP 1 month from cte


With cte as(SELECT month, MIN(member_transactions) as min_member_transactions FROM monthly_insights 
GROUP BY month)
Select TOP 1 month from cte
