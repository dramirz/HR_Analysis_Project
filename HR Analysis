--Table Creation, Views, Window_Functions, Union, CTE, Data Exploration

Create Table hr ( --After creating this table on SQL server, I copied and pasted the rows from MFGEmployees.XLSX
Employee_Number int,
Surname varchar(50),
GivenName varchar(50),	
Gender varchar(10),
City	 varchar(50),
Job_Title varchar(50),	
Department_Name varchar(25),
Store_Location varchar(40),
Division varchar(45),
Age decimal(4,2),
Length_Service decimal(4,2),
Absent_Hours decimal(5,2),
Business_Unit varchar(25)
)

Create View hrsummary as --Creates a VIEW
select 
Count(Employee_number) as Number_of_Employees, Gender, Department_Name, Job_Title,
AVG(Age) as Average_Age, 
AVG(Length_Service) as Avg_Length_of_Service,--(Years)
AVG(Absent_Hours) as Avg_Time_Off, --(Hours)
Min(Absent_Hours) as Minimum_Time_Off, --(Hours)
Max(Absent_Hours) as Max_Time_Off, --(Hours)
SUM(Absent_Hours) as Total_Time_Off --(Hours)
from hr 
GROUP BY Gender, Job_Title, Department_Name, Job_Title








--Shows by department the total amount of absenteeism
select Department_Name, Avg_Length_of_Service, Total_Time_Off from hrsummary
Order by Total_Time_Off desc


--Shows the number of employees, Time_off_Average_Age for those workers working with company up to 10 years and more
--than 11 years
Select Count(Employee_Number) count_of_employees,sum(Absent_Hours)as Time_Off,AVG(Age) as Average_Age from hr
Where Length_Service between 0 AND 10.99--Length_Service >= 11


--Shows are age plays a factor in absenteeism
Select Count(Employee_Number) count_of_employees,sum(Absent_Hours)as Time_Off,AVG(Length_Service) as Length_of_Service from hr
Where Age Between 18 AND 30 --Between 31 AND 65






